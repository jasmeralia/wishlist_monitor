<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="color-scheme" content="light dark">
  <meta name="supported-color-schemes" content="light dark">
  <title>{{ title or ("Wishlist update â€“ " ~ platform|capitalize) }}</title>

  <style>
    /* ============================================================
       BASE (GMAIL FALLBACK) â€“ LIGHT THEME
       Gmail Desktop dark mode will use THIS, not the dark theme.
       ============================================================ */
    body {
      background: #F1F3F4 !important;
      color: #202124 !important;
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }
    .container {
      max-width: 800px;
      margin: 0 auto;
      padding: 16px;
    }
    .card {
      background: #FFFFFF !important;
      border: 1px solid #E0E0E0 !important;
      border-radius: 8px;
      padding: 10px;
      margin-bottom: 10px;
    }
    a {
      color: #1a73e8 !important;
    }

    /* ============================================================
       TRUE DARK MODE â€“ applied in all NON-GMAIL clients
       Gmail Desktop strips prefers-color-scheme, so this is safe.
       ============================================================ */
    @media (prefers-color-scheme: dark) {

      body {
        background: #202124 !important;
        color: #E8EAED !important;
      }

      .container {
        background: #202124 !important;
      }

      h2, h3 {
        color: #E8EAED !important;
      }

      .card {
        background: #2A2C2F !important;
        border-color: #3C4043 !important;
        color: #E8EAED !important;
      }

      a {
        color: #8AB4F8 !important;
      }

      .removed {
        color: #FF6B6B !important;
      }
    }

    /* ============================================================
       HARD GMAIL WEB DARK-MODE BYPASS
       Gmail removes selectors with attribute hacks.
       ============================================================ */
    u + .container body {
      background: #202124 !important;
      color: #E8EAED !important;
    }
  </style>
</head>
<body>
  <div class="container">

    <h2>Wishlist update â€“ {{ platform|capitalize }}</h2>
    <div>{{ summary_html|safe }}</div>

    {% if added %}
      <h3>ðŸŸ¢ Added</h3>
      {% for item in added %}
        <div class="card">
          <div><strong>{{ item.name }}</strong></div>
          <div>{{ item.price_str }}</div>
          {% if item.image_url %}
            <img src="{{ item.image_url }}" width="64" height="64" alt="" style="border-radius:6px;object-fit:cover;" />
          {% endif %}
          {% if item.product_url %}
            <div><a href="{{ item.product_url }}">View item</a></div>
          {% endif %}
        </div>
      {% endfor %}
    {% endif %}

    {% if removed %}
      <h3>ðŸ”´ Removed</h3>
      {% for item in removed %}
        <div class="card">
          <div><strong>{{ item.name }}</strong></div>
          <div class="removed">Removed</div>
        </div>
      {% endfor %}
    {% endif %}

    {% if price_changes %}
      <h3>ðŸŸ¡ Price Changes</h3>
      {% for c in price_changes %}
        <div class="card">
          <div><strong>{{ c.item.name }}</strong></div>
          <div>
            {{ c.before_str }} â†’ {{ c.after_str }}
            {% if c.pct_str %}
              <span style="color:{{ c.color }} !important;">{{ c.pct_str }}</span>
            {% endif %}
          </div>
          {% if c.item.image_url %}
            <img src="{{ c.item.image_url }}" width="64" height="64" alt="" style="border-radius:6px;object-fit:cover;" />
          {% endif %}
          {% if c.item.product_url %}
            <div><a href="{{ c.item.product_url }}">View item</a></div>
          {% endif %}
        </div>
      {% endfor %}
    {% endif %}

    <div style="margin-top:20px;font-size:11px;color:#9AA0A6 !important;text-align:center;">
      This email was sent by
      <a href="https://github.com/jasmeralia/wishlist_monitor">Wishlist Monitor</a>
      Â© 2025 by
      <a href="https://x.com/jasmeralia">Morgan Blackthorne</a>
      <a href="https://x.com/jasmeralia">
        <img src="https://abs.twimg.com/responsive-web/client-web/icon-ios.b1fc7275.png"
             width="14" height="14" style="vertical-align:middle;" />
      </a>
      <a href="https://discord.gg/Seyngsh5MF">
        <img src="https://raw.githubusercontent.com/jasmeralia/wishlist_monitor/master/static/icons/discord.png"
         width="14" height="14" style="vertical-align:middle;" />
      </a>
    </div>

  </div>
</body>
</html>
